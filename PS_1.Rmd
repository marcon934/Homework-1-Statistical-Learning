---
title: "PS1_SL"
author: 'Marco Navarro UTIED: mn27484'
date: "2023-01-24"
output: md_document
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE, cache=TRUE)
library(haven)
library(tidyverse)
library(kableExtra)
library(broom)
library(ggplot2)
```

# 2) Wrangling the Olympics

## A)

```{r A, include =FALSE}
olympics = read.csv('~/data/olympics_top20.csv')

athletics_female = olympics %>%
  filter(sex=="F" & sport=="Athletics") 


result1 = as.data.frame(quantile(athletics_female$height, probs = c(.05,.25, .5, .75, .95)))
colnames(result1) = "Percentiles of heights for female competitors across all Athletics events"
```

```{r A2, echo= FALSE}
result1
```

The 95th percentile of heights for female competitors across all Athletics events 183 centimeters.

## B)

```{r B, include =FALSE}

female_olympics= olympics %>%
  filter(sex=="F")

#heightsd = female_olympics %>%
#group_by(event) %>% 
#summarize(Standard_Deviation = sd(height)) 

heightsd = female_olympics %>%
group_by(event) %>% 
summarize(Standard_Deviation = sd(height)) 


heightsd <- heightsd[with(heightsd,order(-Standard_Deviation)),]

heightsd <- heightsd[1:10,]

```


```{r B2, echo= FALSE}
tibble(heightsd)  
```

If we use standard deviation as a measure of variability, Swimming Women's 100 metres Butterfly is the single women's event that had the greatest variability in competitor's heights across the entire history of the Olympics.

## C)

```{r C1, include =FALSE}

swimmers = olympics %>%
  filter(sport=="Swimming") 

averageage = swimmers  %>% 
group_by(sex, year) %>% 
summarize(Average_Age = mean(age))
```


```{r C2, echo=FALSE}
ggplot(averageage) +
  geom_line(aes(x=year,y=Average_Age, color= sex ),linewidth = 1.5) +
  theme(legend.position="bottom")+
          ggtitle("Average age of swimmers by year and sex") +
  theme(plot.title = element_text(color = "black", size = 16, hjust = 0.5))+
   ylim(10, 32)+
  labs(y= "", x = "Year")
```

The average age of male swimmers in the Olympics presents an upward trend during the first period (100-1924), reaching its maximum (32 years) in the 1924 summer Olympics. After that peak, the average fell dramatically and remained relatively constant around 20 years in the following 5 decades. In most recent years, it shows again an increasing trend and it reached 24 years during the 2016 Olympics. On the other hand, the first Olympics with date for female swimmers was 1924 and their average age was 18 years old. That average remains relatively constant for fifty years and started to show a growing trend since 1984. As a result of this trend, the average age of female swimmers was 22 years old in the 2016 Olympics in Rio de Janeiro. In general, both group of swimmers presents similar trends, the average remained relatively constant from mid-1920s to 1980 and started to show an increase in the last 4 decades.

